var badgin=function(e){"use strict";let t=!1;const n=()=>{t||"ExperimentalBadge"in window||"setExperimentalAppBadge"in navigator||(console.warn("Badging API must be enabled. Please check here how you can enable it: https://developers.google.com/web/updates/2018/12/badging-api#use"),t=!0)},i={mediaQuery:null,value:0};function o(){return"ExperimentalBadge"in window&&!!window.ExperimentalBadge}function a(){return"setExperimentalAppBadge"in navigator&&!!navigator.setExperimentalAppBadge&&"clearExperimentalAppBadge"in navigator&&!!navigator.clearExperimentalAppBadge}function r(){return i.mediaQuery||(i.mediaQuery=window.matchMedia("(display-mode: standalone)"),i.mediaQuery.onchange=(e=>{l(i.value)})),i.mediaQuery.matches&&(o()||a())}function l(e){return i.value=e,r()?o()?(window.ExperimentalBadge.set(e),!0):!!a()&&(navigator.setExperimentalAppBadge(e),!0):(n(),!1)}function c(e,t){for(const n of Object.keys(t))t[n]instanceof Object&&Object.assign(t[n],c(e[n],t[n]));return Object.assign(e||{},t),e}function s(e){return void 0!==e&&Number.isInteger(e)&&e>=0}const d=0,u={backgroundColor:"#424242",color:"#ffffff",indicator:"!"},g=()=>{const e=document.head.getElementsByTagName("link"),t=[];for(let n=0;n<e.length;n++){const i=e[n],o=i.getAttribute("href"),a=i.getAttribute("rel");o&&(a&&-1!==a.split(" ").indexOf("icon")&&t.push(i))}return t},m=()=>{const e=g();let t=null,n=0;for(let i=0;i<e.length;i++){const o=e[i],a=o.getAttribute("sizes");if(!a){t||(t=o,n=0);continue}if("any"===a)return o;const r=parseInt(a.split("x")[0],10);Number.isNaN(r)?t||(t=o,n=0):r>n&&(t=o,n=r)}return t},f={favicons:null,bestFavicon:null,bestFaviconImage:null,value:d,options:u},p=window.matchMedia("screen and (min-resolution: 2dppx)"),v=()=>Math.ceil(window.devicePixelRatio)||1,h=()=>{console.log("handleRatioChange"),B(f.value,f.options)},b=()=>16*v(),w=(e,t,n)=>{const i=b(),o=document.createElement("canvas");o.width=i,o.height=i;const a=o.getContext("2d");a&&(e.width=i,e.height=i,a.drawImage(e,0,0,e.width,e.height),x(a,t,n),(e=>{if(!e)return;for(const e of g())e.parentNode&&e.parentNode.removeChild(e);const t=document.createElement("link");t.id="badgin",t.type="image/x-icon",t.rel="icon favicon",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)})(o.toDataURL()))},x=(e,t,n)=>{let i="";if(!(i=s(t)?0===t?"":t<100?String(t):"99+":n.indicator))return;const o=b(),a=v(),r=i.length-1,l=Math.min(8*a+4*a*r,o),c=o-7*a,d=o-l,u=16*a,g=16*a,m=3*a;e.save(),e.globalAlpha=1,e.fillStyle=n.backgroundColor,e.strokeStyle=n.backgroundColor,e.lineWidth=a,e.beginPath(),e.moveTo(d+m,c),e.quadraticCurveTo(d,c,d,c+m),e.lineTo(d,u-m),e.quadraticCurveTo(d,u,d+m,u),e.lineTo(g-m,u),e.quadraticCurveTo(g,u,g,u-m),e.lineTo(g,c+m),e.quadraticCurveTo(g,c,g-m,c),e.closePath(),e.fill(),e.restore(),e.save(),e.font=`${7*a}px Arial`,e.fillStyle=n.color,e.textAlign="center",e.textBaseline="top",e.fillText(i,d+l/2,9*a+1),e.restore()};function y(){return!!m()}function B(e,t){if(f.value=e,c(f.options,t||{}),!y())return!1;if(!f.bestFavicon){const e=m();if(e){const t=document.createElement("img");e.href.match(/^data/)||(t.crossOrigin="anonymous"),t.src=e.href,f.bestFavicon=e,f.bestFaviconImage=t}p.addListener(h)}return f.favicons||(f.favicons=g()),!!f.bestFaviconImage&&(f.bestFaviconImage.complete?(w(f.bestFaviconImage,f.value,f.options),!0):(f.bestFaviconImage.addEventListener("load",function(){w(this,f.value,f.options)}),!0))}const E={title:null,value:0,options:{indicator:"!"}};function A(e,t){return null===E.title&&(E.title=document.title,Object.defineProperty(document,"title",{get:()=>E.title,set:e=>{E.title=e,function(e,t,n){let i=e;i=s(t)?0===t?e:`(${t}) ${e}`:`(${n.indicator}) ${e}`;const o=document.querySelector("title");o&&(o.childNodes[0].nodeValue=i)}(E.title,E.value,E.options)}})),E.value=e,c(E.options,t||{}),document.title=document.title,!0}return e.clear=function(){r()&&(o()?window.ExperimentalBadge.clear():a()&&navigator.clearExperimentalAppBadge()),function(){if(y()&&(f.value=d,f.options=u,p.removeListener(h),f.favicons)){for(const e of g())e.parentNode&&e.parentNode.removeChild(e);for(const e of f.favicons)document.head.appendChild(e);f.favicons=null,f.bestFavicon=null,f.bestFaviconImage=null}}(),E.value=0,document.title=document.title},e.set=function(e,t={}){switch(t.method){case void 0:case"Badging":if(l(e)&&"Badging"===t.method)break;case"Favicon":if(B(e,t.favicon))break;default:A(e,t.title)}},e}({});
